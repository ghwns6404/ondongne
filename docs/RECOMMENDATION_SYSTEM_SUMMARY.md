# 사용자 맞춤 추천 시스템 - 한 페이지 요약

## 🎯 목적
사용자의 행동 패턴(좋아요, 조회)을 분석하여 개인화된 상품 추천 제공

---

## 🔄 작동 원리

### 1단계: 데이터 수집
- 사용자가 좋아요 클릭 → `favoriteUserIds`에 추가
- 상품 상세 화면 진입 → `viewCount` 증가, `viewedUserIds`에 추가

### 2단계: 선호도 분석
```
좋아요/조회한 상품 수집
    ↓
카테고리별 그룹화
    ↓
카테고리별 빈도 계산
    ↓
카테고리별 평균 가격 계산
    ↓
빈도순 정렬 (상위 3개 선택)
```

### 3단계: 추천 생성
```
각 선호 카테고리에서 상품 검색
    ↓
필터링:
  - 가격대: 평균 ±50%
  - 중복 제거 (이미 본/좋아요한 것)
  - 자기 상품 제외
    ↓
인기도 점수 계산: (조회수×2) + (좋아요×5)
    ↓
정렬 & 상위 N개 선택
```

---

## 📊 핵심 공식

### 인기도 점수
```
점수 = (조회수 × 2) + (좋아요 수 × 5)
```

**이유:** 좋아요는 조회보다 더 강한 관심 신호

### 가격 필터
```
허용 범위 = 평균 가격 ± (평균 가격 × 0.5)
```

**예시:** 평균 55만원 → 27.5만원 ~ 82.5만원

---

## 💡 예시

### 사용자 활동
- 좋아요: 노트북(50만원), 노트북(60만원), 게임기(30만원)
- 조회: 노트북(55만원), 게임기(25만원)

### 분석 결과
| 카테고리 | 빈도 | 평균 가격 |
|---------|------|----------|
| 노트북 | 4 | 55만원 |
| 게임기 | 2 | 27.5만원 |

### 추천 결과
1. 노트북 A: 56만원 (인기도 1위) ✅
2. 노트북 B: 52만원 (인기도 2위) ✅
3. 게임기 C: 30만원 (인기도 1위) ✅

---

## 🛠️ 기술 스택

- **Frontend**: Flutter (Dart)
- **Backend**: Firebase Firestore
- **데이터 모델**: Product (viewCount, viewedUserIds, favoriteUserIds)

---

## ✨ 특징

1. **실시간 반영**: 사용자 활동 즉시 추천 업데이트
2. **스마트 필터링**: 가격, 카테고리, 중복 제거
3. **안정성**: 인덱스 없어도 작동, 에러 시 기본 추천
4. **확장 가능**: AI 통합 준비 완료

---

## 📈 성과 지표

- 추천 상품 클릭률
- 추천 상품 좋아요율
- 구매 전환율

---

**문서 버전:** 1.0  
**최종 업데이트:** 2024년

